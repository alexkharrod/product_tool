{% extends "base.html" %}
{% block content %}
<div class="container mt-4">
  <h2>{% if product %}Edit Product{% else %}Create New Product{% endif %}</h2>
  <form method="POST" enctype="multipart/form-data">
    {{ create_form.hidden_tag() }}
    
    <div class="form-group">
      {{ create_form.name.label }} {{ create_form.name(class="form-control") }}
    </div>
    
    <div class="form-group">
      {{ create_form.description.label }} {{ create_form.description(class="form-control") }}
    </div>

    <!-- Pricing Tiers Section -->
    <div class="card mb-4">
      <div class="card-header">
        Pricing Tiers
        <button type="button" class="btn btn-sm btn-primary float-right" id="add-tier">
          Add Tier
        </button>
      </div>
      <div class="card-body" id="tiers-container">
        <div class="tier-row mb-2">
          <div class="row">
            <div class="col">
              <input type="number" class="form-control" name="tier-min" placeholder="Min quantity" required>
            </div>
            <div class="col">
              <input type="number" class="form-control" name="tier-price" placeholder="Price per unit" step="0.01" required>
            </div>
            <div class="col-auto">
              <button type="button" class="btn btn-danger remove-tier">&times;</button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <button type="submit" class="btn btn-primary">Save Product</button>
  </form>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
  const container = document.getElementById('tiers-container');
  
  document.getElementById('add-tier').addEventListener('click', function() {
    const newRow = container.children[0].cloneNode(true);
    newRow.querySelectorAll('input').forEach(input => input.value = '');
    container.appendChild(newRow);
  });

  container.addEventListener('click', function(e) {
    if(e.target.classList.contains('remove-tier')) {
      if(container.children.length > 1) {
        e.target.closest('.tier-row').remove();
      }
    }
  });
});
</script>
{% endblock %}
